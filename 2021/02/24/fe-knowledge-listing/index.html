<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="chen wen jun's blog"><meta name="baidu-site-verification" content="no5dkv1A7T"><title>前端知识整理 | EL PSY CONGROO</title><link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/pure/0.6.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/pure/0.6.0/grids-responsive-min.css"><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css"><script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.0.0/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><script type="text/javascript" src="/js/main.js"></script><script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.6.0/highlight.min.js"></script><link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.6.0/styles/default.min.css"><script type="text/javascript" src="/js/post.js"></script><meta name="generator" content="Hexo 6.3.0"></head><body></body><div id="header"><div class="body_container"><div id="nav-menu"><a class="current" href="/."> 主页</a><a href="/archives/"> 归档</a><a target="_blank" rel="noopener" href="https://next.yo-cwj.com"> 项目</a><a href="/about/"> 关于</a></div><div class="site-name"><img class="avatar" src="/./img/avatar.png"><div class="theme-selector"><div class="selector" onclick="document.body.className = 't1';localStorage.setItem('yo-cwj-theme', 't1')" style="background: #00c7ff;"></div><div class="selector" onclick="document.body.className = 't2';localStorage.setItem('yo-cwj-theme', 't2')" style="background: #ffe100;"></div><div class="selector" onclick="document.body.className = 't3';localStorage.setItem('yo-cwj-theme', 't3')" style="background: #55ff00;"></div></div><br><h1 class="hidden">前端知识整理</h1><a id="logo" href="/.">EL PSY CONGROO</a><p class="description">陈文俊的博客</p><p class="links"><a target="_blank" rel="noopener" href="https://segmentfault.com/u/xpang"><img src="/./img/sf.ico"></a><a target="_blank" rel="noopener" href="https://github.com/cwj0417"><img src="/./img/github.png"></a><a target="_blank" rel="noopener" href="https://dribbble.com/fjonas"><img src="/./img/dribbble.ico"></a><a target="_blank" rel="noopener" href="https://weibo.com/2719310113"><img src="/./img/weibo.ico"></a></p></div></div></div><div class="body_container"><div class="pure-g" id="layout"><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><div class="search-form"><input id="local-search-input" placeholder="搜索内容或标题" type="text" name="q" results="0"/><div id="local-search-result"></div></div></div><div class="widget"><div class="widget-title"><i class="fa fa-paperclip"> </i>标签</div><div class="tagcloud"><a href="/tags/%E5%85%A5%E9%97%A8/" style="font-size: 20px;">入门</a> <a href="/tags/webpack/" style="font-size: 20px;">webpack</a> <a href="/tags/vue/" style="font-size: 19.5px;">vue</a> <a href="/tags/javascript/" style="font-size: 19px;">javascript</a> <a href="/tags/%E7%BF%BB%E8%AF%91/" style="font-size: 18.5px;">翻译</a> <a href="/tags/%E6%B7%B1%E5%85%A5es6/" style="font-size: 18px;">深入es6</a> <a href="/tags/%E5%BA%94%E7%94%A8/" style="font-size: 17.5px;">应用</a> <a href="/tags/vue%E6%BA%90%E7%A0%81/" style="font-size: 17.5px;">vue源码</a> <a href="/tags/%E5%88%86%E6%9E%90/" style="font-size: 17.5px;">分析</a> <a href="/tags/%E5%BF%83%E7%90%86%E5%AD%A6/" style="font-size: 17px;">心理学</a> <a href="/tags/electron/" style="font-size: 17px;">electron</a> <a href="/tags/react/" style="font-size: 16.5px;">react</a> <a href="/tags/haha/" style="font-size: 16px;">haha</a> <a href="/tags/%E5%8D%9A%E5%AE%A2%E8%A3%85%E9%A5%B0/" style="font-size: 16px;">博客装饰</a> <a href="/tags/%E4%BA%BA%E6%A0%BC%E5%BF%83%E7%90%86%E5%AD%A6/" style="font-size: 16px;">人格心理学</a> <a href="/tags/%E4%BB%A3%E7%A0%81%E7%BB%84%E7%BB%87/" style="font-size: 15.5px;">代码组织</a> <a href="/tags/%E8%B5%84%E6%9C%AC%E8%AE%BA/" style="font-size: 15.5px;">资本论</a> <a href="/tags/angular/" style="font-size: 15px;">angular</a> <a href="/tags/d3/" style="font-size: 15px;">d3</a> <a href="/tags/%E5%B0%8F%E7%A8%8B%E5%BA%8F/" style="font-size: 15px;">小程序</a> <a href="/tags/ssr/" style="font-size: 15px;">ssr</a> <a href="/tags/nuxt/" style="font-size: 15px;">nuxt</a> <a href="/tags/ae-exp/" style="font-size: 14.5px;">ae exp</a> <a href="/tags/immer/" style="font-size: 14.5px;">immer</a> <a href="/tags/chrome-extension/" style="font-size: 14.5px;">chrome extension</a> <a href="/tags/codemirror/" style="font-size: 14.5px;">codemirror</a> <a href="/tags/vite/" style="font-size: 14.5px;">vite</a> <a href="/tags/ci/" style="font-size: 14.5px;">ci</a> <a href="/tags/github-action/" style="font-size: 14.5px;">github action</a> <a href="/tags/monorepo/" style="font-size: 14.5px;">monorepo</a> <a href="/tags/http/" style="font-size: 14.5px;">http</a> <a href="/tags/git/" style="font-size: 14.5px;">git</a> <a href="/tags/%E4%BA%94%E8%A1%8C%E5%85%AB%E5%8D%A6/" style="font-size: 14.5px;">五行八卦</a> <a href="/tags/vuex/" style="font-size: 14.5px;">vuex</a> <a href="/tags/redux/" style="font-size: 14.5px;">redux</a> <a href="/tags/%E5%B9%B4%E7%BB%88%E6%80%BB%E7%BB%93/" style="font-size: 14px;">年终总结</a> <a href="/tags/%E6%91%A9%E6%89%98%E8%BD%A6/" style="font-size: 14px;">摩托车</a> <a href="/tags/chrome-extension/" style="font-size: 14px;">chrome-extension</a> <a href="/tags/vscode/" style="font-size: 14px;">vscode</a> <a href="/tags/%E9%A2%9C%E8%89%B2/" style="font-size: 14px;">颜色</a> <a href="/tags/eslint/" style="font-size: 14px;">eslint</a> <a href="/tags/svg/" style="font-size: 14px;">svg</a> <a href="/tags/shortcuts/" style="font-size: 14px;">shortcuts</a> <a href="/tags/web/" style="font-size: 14px;">web</a> <a href="/tags/%E6%8A%93%E5%8C%85/" style="font-size: 14px;">抓包</a> <a href="/tags/hook/" style="font-size: 14px;">hook</a> <a href="/tags/typescript/" style="font-size: 14px;">typescript</a> <a href="/tags/%E9%81%93%E5%BE%B7%E6%83%85%E6%93%8D%E8%AE%BA/" style="font-size: 14px;">道德情操论</a> <a href="/tags/jenkins/" style="font-size: 14px;">jenkins</a> <a href="/tags/%E6%AD%A3%E5%88%99/" style="font-size: 14px;">正则</a> <a href="/tags/%E6%95%B0%E5%AD%A6%E7%9A%84%E9%9B%A8%E4%BC%9E%E4%B8%8B/" style="font-size: 14px;">数学的雨伞下</a> <a href="/tags/esbuild/" style="font-size: 14px;">esbuild</a> <a href="/tags/%E7%9B%B8%E5%AF%B9%E8%AE%BA/" style="font-size: 14px;">相对论</a> <a href="/tags/cordova/" style="font-size: 14px;">cordova</a> <a href="/tags/vite-plugin/" style="font-size: 14px;">vite-plugin</a> <a href="/tags/weex/" style="font-size: 14px;">weex</a> <a href="/tags/%E9%98%BF%E5%BE%B7%E5%8B%92/" style="font-size: 14px;">阿德勒</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-commenting-o"> </i>最近评论</div><div class="epcRecentComments" id="cyReping" role="cylabs" data-use="reping"></div></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> </i>友情链接</div><div class="links"><a href="https://blog.csdn.net/u010416101" title="sean(大数据专家, 人工智能专家)" target="_blank">sean(大数据专家, 人工智能专家)</a><a href="https://blog.csdn.net/u012373815" title="abel(大数据专家, 人工智能专家)" target="_blank">abel(大数据专家, 人工智能专家)</a><a href="https://di1shuai.com/" title="bruce(大数据专家, 人工智能专家)" target="_blank">bruce(大数据专家, 人工智能专家)</a><a href="https://www.cnblogs.com/linxiyue/" title="邓雪(全栈开发专家)" target="_blank">邓雪(全栈开发专家)</a><a href="https://www.xilanhua-c7.top/" title="赵吉(后现代浪漫主义诗人)" target="_blank">赵吉(后现代浪漫主义诗人)</a><a href="https://blog.csdn.net/weixin_40413961" title="98年新栋(首席实习生)" target="_blank">98年新栋(首席实习生)</a></div></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">前端知识整理</h1><div class="post-meta">Feb 24, 2021<span> | </span><span class="category"><a href="/categories/%E5%B7%A5%E4%BD%9C%E7%AC%94%E8%AE%B0/">工作笔记</a></span><script src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" async></script><span id="busuanzi_container_page_pv"> | <span id="busuanzi_value_page_pv"></span><span> 次阅读</span></span></div><div class="post-content"><p>前端知识整理一波, 会则复习不会则补.</p>
<span id="more"></span>

<h2 id="总则"><a href="#总则" class="headerlink" title="总则"></a>总则</h2><p>这里打算整理狭义上的前端内容: 基于html, css, js的前端. 而在这三者间有交叉的技术和生态和衍生, 还有靠近的服务端相关的知识.</p>
<ul>
<li><p><strong>html</strong>指在浏览器上运行的页面. 所以知识点包含浏览器的相关行为:</p>
<ul>
<li>http相关, 请求的类型, 缓存, 跨域.</li>
<li>浏览器渲染html相关: 加载顺序, 绘制&#x2F;重绘机制.</li>
<li>dom, bom相关: 浏览器提供的api, event loop和渲染的关系.</li>
</ul>
</li>
<li><p><strong>css</strong>的知识我认为分2块, 第一是对css系统的认识, 不同的块流, 文本流, 布局等. 第二是零碎的情况的知识. 至于前沿的css语法我认为不属于基础也不那么重要. 预编译的css算是个类似语法, 预编译的过程其实属于工程化.</p>
</li>
<li><p><strong>类html,css</strong>第一个想到的是小程序. 是一系列其实不是html和css但模拟语法让干前端的人能做的事.</p>
</li>
<li><p>涉及到node服务端的常用点有开发时服务器, ssr, 前后端分离解决跨域的转发服务器.</p>
</li>
<li><p>语言<strong>javascript</strong>. 虽然ts是js的超集, 但我还是把它归类为js. 语言的范畴是数据类型, 作用域&#x2F;闭包, 原型链, 数据结构, 算法等. 不包含bom, dom相关的api和特性.</p>
</li>
<li><p><strong>工程化</strong>包含webpack, babel, 到部署运维. </p>
<ul>
<li>ts, jsx, es+, vue文件都是不能直接在浏览器上抛的, 就必须用到编译器.</li>
<li>代码的压缩, 复用代码的组织必须用打包工具. 开发的时候也需要用开发工具而不像以前保存刷新. </li>
<li>部署运维更偏向于每个公司内部的部落规则, 但也有一些微前端框架.</li>
</ul>
<p>以上各个工具化现在主流的webpack, rollup, vite的使用和区别. 还有零散和过时的工具grant, gulp, parcel, snowpack, yoemen(vscode在用)啥的. 工具的区别是基于不同的打包目标, js不同模块引入方式(amd, cmd, umd, esm).</p>
</li>
<li><p>框架我只用过vue2和react. 框架的了解分2个方向, api和源码. 其实在效用上两者重要程度说不清高地, 但现在一般的标准是: api是默认全懂, 源码才可聊.</p>
<p>当然也只有读了源码才知道框架的原理. 源码阅读也分2个方向, 主流程和细节. 我建议先流程后细节的. 而最佳方式是带问题读.</p>
</li>
<li><p><strong>优化</strong>, 无论是html, 首屏, webpack速度, 框架, 数据结构. 本质都是使行为更合理, 减少浪费. 所以优化本身不能作为一个知识点, 而是一个话题. 想优化就要去理解和深入各个知识点本身.</p>
</li>
</ul>
<p>另外<a target="_blank" rel="noopener" href="https://github.com/cwj0417/sxdm">手写代码合集</a><strong>直接在github上</strong>.</p>
<p>那么接下来就(不太全面地)分模块, 复习一些基础问题. </p>
<h2 id="javascript"><a href="#javascript" class="headerlink" title="javascript"></a>javascript</h2><h3 id="作用域与this"><a href="#作用域与this" class="headerlink" title="作用域与this"></a>作用域与this</h3><p>函数的执行有执行栈, 栈底是全局作用域, 执行的时候创建作用域并入栈, 执行完毕出栈.</p>
<p>在创建作用域的时候:</p>
<ul>
<li><p>决定this的值: 谁调用this就是谁. (箭头函数找上一层)</p>
</li>
<li><p>决定环境中变量的实际地址. (非全局作用域多一个arguments, 全局的多一些原形函数)</p>
<p>变量提升的原因是: var被当做变量处理, let和const被当做词法处理.</p>
</li>
<li><p>决定外部引用环境. (作用域栈的下一个, 变量找不到会去这里找) 全局的外部环境是null</p>
</li>
</ul>
<h3 id="event-loop"><a href="#event-loop" class="headerlink" title="event loop"></a>event loop</h3><p>执行栈是函数执行而来的, event loop是决定函数执行顺序的, 也决定了ui渲染和各个来源函数执行的顺序.</p>
<p>浏览器中除了promise是微任务, 其余全是宏任务, 包用户输入, setTimout, callback.</p>
<p>宏任务有多个队列, 微任务只有一个队列. 表现为无论在执行宏任务还是微任务, 执行完都会检查微任务队列.</p>
<p>所以如果有比较难分辨的情况, 我认为难点在于要理解: <strong>宏任务有多个队列</strong>. 要分清那几个任务是在同一个队列里的. 这里贴一个题目.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">setTimeout</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;定时器开始啦&#x27;</span>)</span><br><span class="line">&#125;);</span><br><span class="line"><span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="keyword">function</span>(<span class="params">resolve</span>)&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;马上执行for循环啦&#x27;</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="number">10000</span>; i++)&#123;</span><br><span class="line">        i == <span class="number">99</span> &amp;&amp; <span class="title function_">resolve</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;).<span class="title function_">then</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;执行then函数啦&#x27;</span>)</span><br><span class="line">&#125;);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;代码执行结束&#x27;</span>);</span><br></pre></td></tr></table></figure>

<h3 id="原型"><a href="#原型" class="headerlink" title="原型"></a>原型</h3><ul>
<li><p>原型: <strong>__proto__</strong> 属性是个accessor属性, 实际是Object.getPropertyOf和Object.setPropertyOf.</p>
</li>
<li><p>隐式操作: 平时的字面量对象, <code>.</code>操作取值, 赋值. 实际都有隐式操作. 取值会往__proto__找, 赋值如果当前变量没就创建. </p>
<p>字面量创建的对象有默认__proto__, 并不是空对象. 用es6省略value会创建null为原型的对象.</p>
</li>
<li><p>构造函数: 所有函数都会被挂上prototype属性. 这个属性会在被new的时候作为实例的__proto__. 内容是: {constructor: 自己, <strong>__proto__</strong>: Object.prototype}, 在继承的时候__proto__是父对象的constructor, 构造函数的__proto__也是父对象的构造函数.</p>
</li>
<li><p>class的extends&#x2F;寄生组合式继承: 子类的__proto__的父类, 子类的prototype的__proto__是父类的prototype.</p>
</li>
<li><p>一些基本对象(Object, Array, Function等)的关系可以自己用__proto__和&#x3D;&#x3D;&#x3D;和instanceof去画关系.</p>
</li>
</ul>
<h3 id="ts"><a href="#ts" class="headerlink" title="ts"></a>ts</h3><p>ts这个标题太大, 而且特性&#x2F;配置都是跟版本的. 就列一些点.</p>
<ul>
<li>keyof: 对象的结果是键的联合类型, 数组是number|数组方法的联合类型, any是string|number|symbol</li>
<li>infer. extends一个泛型接口时需要临时定义的泛型名字.</li>
<li>工具类Partial, Record, Pick, Exclude, ReturnType的实现.</li>
<li>interface和type的区别: 语法&#x2F;implements&#x2F;联合类型&#x2F;extends.</li>
<li>ts特性: 只检查结构, narrow down, 类型之间有包含关系.</li>
</ul>
<h2 id="css"><a href="#css" class="headerlink" title="css"></a>css</h2><h3 id="BFC"><a href="#BFC" class="headerlink" title="BFC"></a>BFC</h3><p>BFC是一个布局环境, 有一定的规律, BFC内部可以嵌套另外独立的BFC.</p>
<p>BFC里的盒子按照常规流从上到下排布, 可能出现margin重叠(这个问题可以用嵌套个新BFC解决).</p>
<p>跟元素就是个BFC, 创建独立BFC的条件是float, position, overflow, flex等.</p>
<h3 id="盒模型"><a href="#盒模型" class="headerlink" title="盒模型"></a>盒模型</h3><p>标准盒子是content-box, IE盒子是border-box. IE盒模型的width多包含了padding和border.</p>
<p>其实设计图的尺寸一般是IE盒模型写起来比较方便.</p>
<h3 id="z轴顺序"><a href="#z轴顺序" class="headerlink" title="z轴顺序"></a>z轴顺序</h3><p>从下到上如下图, 注意的是层叠上下文也是上下文, 也BFC一样有嵌套.</p>
<ol>
<li>background&#x2F;border</li>
<li>z-index负值</li>
<li>块元素</li>
<li>浮动元素</li>
<li>行内元素</li>
<li>z-index: 0, auto</li>
<li>z-index正值</li>
</ol>
<h2 id="webpack"><a href="#webpack" class="headerlink" title="webpack"></a>webpack</h2><h3 id="主流程"><a href="#主流程" class="headerlink" title="主流程"></a>主流程</h3><ol>
<li>从配置文件和命令行参数读取并merge得到配置.</li>
<li>用loader读取资源, 然后收集依赖关系, 分析成ast.</li>
<li>组装成chunk, 输出.</li>
</ol>
<h3 id="loader和plugin"><a href="#loader和plugin" class="headerlink" title="loader和plugin"></a>loader和plugin</h3><p>loader用来读取不同文件, 是一个函数, 接受参数为文件字符串, 输出js或能被下个loader读取的格式. (估计是用compose来组合的, 所以是从右到左.)</p>
<p>plugin是通过tapable的发布&#x2F;订阅系统, 在编译执行的不同步骤会调用不同钩子, 主进程compile, 每个模块的进程compilation. 写法是一个class并含有指定的方法.</p>
<p>自定义loader和plugin的使用还是比较有意思, 比如可以loader给代码加全局catch并发送错误报告给后端.</p>
<h3 id="tree-shaking和scope-hoisting"><a href="#tree-shaking和scope-hoisting" class="headerlink" title="tree-shaking和scope-hoisting"></a>tree-shaking和scope-hoisting</h3><p>在webpack5(可能从4开始)后, production模式是直接开启的, 要求都是纯esm输入.</p>
<p>执行的时间是编译形成ast后, 分析并改变依赖树.</p>
<p>区别: tree-shaking是和”是否被引用到”有关, scope-hoisting是和”代码是否可以简化”有关.</p>
<h3 id="和rollup的区别"><a href="#和rollup的区别" class="headerlink" title="和rollup的区别"></a>和rollup的区别</h3><p>rollup功能少所以配置少, 适合打纯js.</p>
<p>webpack系统比较复杂, 可以打任何品种的文件(css, 图片, 字体, .vue, 任何), 因为loader.</p>
<p>但是webpack不能打出esm包, 所以打算发到npm上给别人用的尽量rollup打.</p>
<h3 id="优化"><a href="#优化" class="headerlink" title="优化"></a>优化</h3><p>优化的本质是让事情更合理, 所以一般通过3个点.</p>
<ul>
<li>把工具(webpack)升级到更高版本, 让专业的人为自己做事.</li>
<li>用各种插件, 也是让专业的人为自己做事. (然后合理的插件会被加入默认配置)</li>
<li>自己代码写好点, 根据自己的需求减少不必要的配置. (这个是可以通过了解webpack来做到的事)</li>
</ul>
<h3 id="babel"><a href="#babel" class="headerlink" title="babel"></a>babel</h3><p>babel的流程和webpack类似. 读取配置&#x2F;插件, 代码转ast, 根据配置输出.</p>
<h2 id="优化-1"><a href="#优化-1" class="headerlink" title="优化"></a>优化</h2><p>其实优化包含的方面特别多, 而不是什么优化都去做的, 实际场景中优化其实出于2个场景: 第一有地方明显卡顿要求优化, 第二系统性优化. 但其实核心思路都是: 找出最卡的点. 找出的方式第一步是肉眼, 第二部是调试工具.</p>
<p>优化除了一些工具, 代码写得好也非常重要, 好的lib作者写代码还会考虑到是不是能被tree-shaking和单元测试覆盖. 以下说的是代码之外的一些东西.</p>
<h3 id="webpack优化"><a href="#webpack优化" class="headerlink" title="webpack优化"></a>webpack优化</h3><p>webpack优化包含prod和dev阶段. </p>
<p>prod阶段目标是减少包体积(tree-shaking和scope-hoisting)和code spliting(为首屏).</p>
<p>dev优化是目标是加快编译流程, 配置hmr.</p>
<p>还有一些根据项目通用的优化, webpack默认配置范围比较大, 而项目一般会narrow一些.</p>
<p>比如配置alias, 项目只有ts文件, 就配上对应的alias. 配置includes&#x2F;excludes, mainFields.</p>
<h3 id="首屏优化"><a href="#首屏优化" class="headerlink" title="首屏优化"></a>首屏优化</h3><p>首屏优化有2个角度, 网络级别, 代码级别.</p>
<p>我们先关注代码级别的, 代码级别优化的本质: <strong>先只加载用户一眼看到的东西.</strong></p>
<p>所以方法有: 用webpack的动态import(框架的router有做), 图片懒加载, 虚拟表格(有不可搜索这个缺点), 先加载skeleton.</p>
<p>动态垫片减少不必要的垫片.</p>
<p>首屏ssr也能提升性能和seo, 但是成本较高, 还要做slb和监控.</p>
<h2 id="web渲染流程"><a href="#web渲染流程" class="headerlink" title="web渲染流程"></a>web渲染流程</h2><h3 id="“输入url到页面展示”"><a href="#“输入url到页面展示”" class="headerlink" title="“输入url到页面展示”"></a>“输入url到页面展示”</h3><p>解析dns &#x3D;&gt; 通过tcp建立http连接 &#x3D;&gt; 发起请求 &#x3D;&gt; 接受数据 &#x3D;&gt; 断开http连接 &#x3D;&gt; 渲染页面</p>
<p>各个点都可以展开很多, 这里整理一下我认为和其他知识对应的深度.</p>
<h3 id="http"><a href="#http" class="headerlink" title="http"></a>http</h3><p>在网络模型中, http协议属于应用层(5或7), 下层的传输层(4)是tcp协议, 网络层(3)是ip协议.</p>
<p>建立连接和断开连接都用tcp进行, 就是传说中的三次握手四次挥手.(断开的过程第三次挥手是服务端发起的).</p>
<p>http1.1默认开启了keep-alive(默认头), 作用是减少建立和断开连接发送的tcp请求. 而是不是支持得看服务器, 协议两端的交互就像打电话的2个人.</p>
<h3 id="渲染网页"><a href="#渲染网页" class="headerlink" title="渲染网页"></a>渲染网页</h3><p>浏览器渲染网页总体有几步, 但不同浏览器实现其实不同.</p>
<ol>
<li>把html parse成dom树.</li>
<li>把css parse成样式树.</li>
<li>通过以上2树, 构造呈现树. dom树和呈现树结构并不相同, 有些标签(head, meta, display为none等)不显示, 而有些标签(select, title属性等)会产生多个呈现树.</li>
<li>通过呈现树计算, 布局. </li>
<li>绘制.</li>
</ol>
<p>然后在元素发生变化后分为部分渲染. 其实前端理解以后能做的优化就是: 减少渲染次数, 而这个事情框架里都做了.</p>
<h3 id="跨域"><a href="#跨域" class="headerlink" title="跨域"></a>跨域</h3><h4 id="什么情况会发生跨域"><a href="#什么情况会发生跨域" class="headerlink" title="什么情况会发生跨域"></a>什么情况会发生跨域</h4><p> 协议, 端口, host(任意级)只要有一个不同就<a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS">跨域</a>.</p>
<h4 id="什么请求会发生跨域"><a href="#什么请求会发生跨域" class="headerlink" title="什么请求会发生跨域"></a>什么请求会发生跨域</h4><ul>
<li>js发起的请求. (通过XMLHttpRequest和fetch)</li>
<li>字体.</li>
<li>WebGL texture.</li>
<li>canvas通过drawImage画的image或者video. (会把canvas变成被污染的状态, 不能toDataUri了)</li>
<li>css里的<code>url()</code>.</li>
</ul>
<h4 id="如何让跨域请求顺利"><a href="#如何让跨域请求顺利" class="headerlink" title="如何让跨域请求顺利"></a>如何让跨域请求顺利</h4><p>设头, 请求端和服务端都要设. 都是Access-Control-开头的.</p>
<p>如果要带上cookie, 加个头withCredentials: true.</p>
<h4 id="preflight请求和简单请求"><a href="#preflight请求和简单请求" class="headerlink" title="preflight请求和简单请求"></a>preflight请求和简单请求</h4><p>在发起非<code>简单请求</code>的跨域请求前, 浏览器会发起preflight请求, method是options, 来确认是否支持即将进行的请求.</p>
<p><code>简单请求</code>的条件比较复杂, 要同时满足: </p>
<ul>
<li>method是get, post, post之一</li>
<li>只能手动设某几个请求头: Accept, Accept-language, Content-language, Content-type.</li>
<li>Content-type只允许几个值: text&#x2F;plain, multipart&#x2F;form-data, application&#x2F;x-www-form-urlencoded.</li>
<li>XMLHttpRequest发起的请求不能监听upload事件.</li>
<li>请求中没有ReadableStream.</li>
</ul>
<p>这些要求正常人是背不出的, 所以只要基础<strong>简单请求是幂等请求</strong>, 非简单请求是会对服务器数据造成改动的.</p>
<h4 id="额外的解决方式"><a href="#额外的解决方式" class="headerlink" title="额外的解决方式"></a>额外的解决方式</h4><p>几个通常的非正常解决方案:</p>
<ul>
<li>jsonp. 通过非<code>会发生跨域的请求方式</code>(上面提到的)来发起跨域的请求, 比如append script.</li>
<li>前端服务器转发. 这个通常是下属地, 带配置host功能的转发服务器.</li>
<li>网关转发.</li>
</ul>
<h3 id="缓存"><a href="#缓存" class="headerlink" title="缓存"></a>缓存</h3><p>缓存就是根据一些头信息, 来决定是否可以用本地缓存数据来替代发起一次新http请求. 浏览器http缓存分2种:</p>
<ul>
<li>强缓存: 通过expires, cache-control等头, 如命中, 直接用缓存, 状态码200, (from disk cache).</li>
<li>协商缓存: 通过last-modified, e-tag, if-none-match来判断, 请求会发出, 如命中, 服务器不传输内容, 返回状态码304来使用缓存.</li>
</ul>
<h3 id="事件流和事件委托"><a href="#事件流和事件委托" class="headerlink" title="事件流和事件委托"></a>事件流和事件委托</h3><p>事件流从document流向目标, 再流向document.</p>
<p>addEventListener最后一个参数可以调整从哪个角度获取事件.</p>
<p>stopProgration和preventDefault能组织捕捉&#x2F;冒泡.</p>
<p>事件委托指, 要给一系列子元素增加事件, 就给他的父元素增加事件, 然后通过event的字段来判断是哪个子元素.</p>
<p>事件委托的原理是利用事件冒泡, 优点是不用重复注册, 以及子节点变化的情况无须重新注册.</p>
<h2 id="安全"><a href="#安全" class="headerlink" title="安全"></a>安全</h2><h3 id="xss"><a href="#xss" class="headerlink" title="xss"></a>xss</h3><p>cross-site scripting, 通过给html输入脚本来攻击, 防止的思路是: 要放到html上的输入要小心. 处理方法就是转义. 一般容易攻击的输入有: url, cookie, 输入框. 总之不要相信用户输入.</p>
<h3 id="csrf"><a href="#csrf" class="headerlink" title="csrf"></a>csrf</h3><p>cross-site request forgery, 在被攻击网站登录状态下, 第三方网站向被攻击网站发起请求, 这样会带着身份信息. 通过不接受跨域请求来防范.</p>
<h2 id="框架"><a href="#框架" class="headerlink" title="框架"></a>框架</h2><p>vue和react后续再看.</p>
</div><div class="post-footer"></div><p> (本文完)</p><p> 如果你觉得本文对你有帮助, 你可以<a href="/about/give-me-a-coffee.html">请我喝一杯咖啡</a></p><p> 本文遵循<a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc/4.0/deed.en">cc协议</a></p><p> 你可以在注明出处和非商用的前提下任意复制及演绎</p><div class="post-footer"></div><div class="tags"><a href="/tags/webpack/">webpack</a><a href="/tags/vue/">vue</a><a href="/tags/immer/">immer</a><a href="/tags/react/">react</a><a href="/tags/javascript/">javascript</a><a href="/tags/http/">http</a></div><div class="post-nav"><a class="pre" href="/2021/05/12/the-practice-of-replacing-url-in-electron-development/">electron开发模式中替换url实践</a><a class="next" href="/2021/02/01/difference-of-reactivity-between-vue2-and-vue3/">比较vue2和vue3的响应式</a></div><div id="SOHUCS"></div></div></div></div><div class="pure-u-1 pure-u-md-4-4"><div id="footer"><p>©&nbsp;<a href="/." rel="nofollow">EL PSY CONGROO. </a><a rel="nofollow" target="_blank" href="http://www.miitbeian.gov.cn/">沪ICP备16053193号-2</a></p><p>Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a> | Designed by hahahaha</p></div></div></div></div><script>document.body.className = localStorage.getItem('yo-cwj-theme') || 't1'
</script><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="https://cy-cdn.kuaizhan.com/js/??lib/jquery.js,changyan.labs.https.js?appid=cyt1bgEED" async></script><script>(function () {
    var appid = 'cyt1bgEED';
    var conf = 'prod_20e8d05c4d6b3ce62b89be98ae18390c';
    var width = window.innerWidth || document.documentElement.clientWidth;
    if (width < 960) {
        var head = document.getElementsByTagName('head')[0]||document.head||document.documentElement;
        var script = document.createElement('script');
        script.type = 'text/javascript';
        script.charset = 'utf-8';
        script.id = 'changyan_mobile_js';
        script.src = 'https://cy-cdn.kuaizhan.com/upload/mobile/wap-js/changyan_mobile.js?client_id=' + appid + '&conf=' + conf;
        head.appendChild(script);
    } else {
        var loadJs=function(d,a){
        var c=document.getElementsByTagName("head")[0]||document.head||document.documentElement;
        var b=document.createElement("script");
        b.setAttribute("type","text/javascript");
        b.setAttribute("charset","UTF-8");b.setAttribute("src",d);
        if(typeof a==="function"){
          if(window.attachEvent){
            b.onreadystatechange=function(){
              var e=b.readyState;
              if(e==="loaded"||e==="complete"){
                b.onreadystatechange=null;
                a();
              }
            }
            }else{
              b.onload=a
            }
          }
          c.appendChild(b)
        };
      loadJs("https://cy-cdn.kuaizhan.com/upload/changyan.js",function(){window.changyan.api.config({appid:appid,conf:conf})});
    }
})();
</script><script type="text/javascript" src="/js/search.js?v=0.0.0"></script><script>var search_path = 'search.xml';
if (search_path.length == 0) {
   search_path = 'search.xml';
}
var path = '/' + search_path;
searchFunc(path, 'local-search-input', 'local-search-result');
</script><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></html>